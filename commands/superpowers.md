# Superpowers Mode

大規模・複雑なタスクに対して、リサーチ・計画・TDD・検証を徹底的に行うモード。
「動く」と言い張るのではなく、実際に検証して証明する。

## タスク

$ARGUMENTS

## 実行プロトコル

### Phase 1: リサーチ（Explore サブエージェント）

Task ツールで Explore サブエージェントを起動し、以下を徹底調査させる:

- タスクに関連するファイル・モジュールの特定
- 既存のアーキテクチャパターン、命名規則、コーディングスタイルの把握
- 依存関係の確認（どこが何に依存しているか）
- テストの構成（テストフレームワーク、ディレクトリ構造、既存テストのパターン）
- 変更が影響しうる範囲の洗い出し

Explore の結果を受け取ってから次のフェーズに進む。推測で進めない。

### Phase 2: 設計（複数アプローチの検討）

リサーチ結果に基づき、最低2つの実装アプローチを検討する:

- **アプローチA**: [具体的な方法]
- **アプローチB**: [具体的な方法]

各アプローチについて以下を明示:
- メリット / デメリット
- 既存コードとの整合性
- 変更量の見積もり
- リスク（破壊的変更、パフォーマンス影響等）

ユーザーに計画を提示し、承認を得てから実装に進む。
承認なしに実装を開始しない。

### Phase 3: TDD（テストファースト）

1. まず失敗するテストを書く
2. テストを実行して失敗することを確認する（`red`）
3. テストを通す最小限の実装を書く（`green`）
4. リファクタリングする（`refactor`）
5. 各サイクルでテストが全て通ることを確認する

テストが存在しないプロジェクトの場合:
- テスト環境のセットアップから行う
- 既存コードに対するリグレッションテストも追加する

### Phase 4: 実装（段階的）

1ステップの変更は50行以内に抑える。各ステップで:

1. コードを変更する
2. テストを実行する（全テスト）
3. Lint / フォーマッターを実行する
4. 型チェックを実行する（TypeScript の場合）
5. 問題があればその場で修正する

問題を先送りしない。各ステップが green の状態を維持する。

### Phase 5: 最終検証

全ての実装が完了したら:

1. テストスイート全体を実行する
2. Lint / 型チェックをパスさせる
3. 手動での動作確認が必要な場合は、具体的な確認手順を示す
4. 変更のサマリーを出力する:
   - 変更したファイル一覧
   - 追加したテスト一覧
   - 既知の制限事項・今後の課題

## ルール

- 推測で「動くはず」と言わない。実際にコマンドを実行して確認する
- エラーが出たら無視せず、その場で対処する
- 「後で直す」は禁止。今直す
- ユーザーの承認なしにアーキテクチャ変更や新しい依存関係の追加をしない
- 各フェーズの完了をユーザーに報告する
